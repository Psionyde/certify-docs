<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Using Certificates in Windows · Certify The Web - Docs</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Using Certificates in Windows · Certify The Web - Docs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://certifytheweb.com/index.html"/><meta property="og:description" content="Using SSL/TLS certificates in Windows has a few aspects that can prevent your site working properly if don&#x27;t know about them. This guide outlines some key points. **See the special mention below for limitations regarding Windows Server 2008 R2 (IIS 7.5) and lower.**"/><meta property="og:image" content="https://certifytheweb.com/img/favicon.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://certifytheweb.com/img/favicon.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/icon.svg" alt="Certify The Web - Docs"/><h2 class="headerTitleWithLogo">Certify The Web - Docs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/intro.html" target="_self">Getting Started</a></li><li class="siteNavGroupActive"><a href="/docs/faq.html" target="_self">FAQ</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Useful Info</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/docs/intro.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/letsencrypt.html">What is Let&#x27;s Encrypt?</a></li><li class="navListItem"><a class="navItem" href="/docs/certificate-process.html">Certificate Request Process</a></li><li class="navListItem"><a class="navItem" href="/docs/ui-options.html">Guide to UI Options</a></li><li class="navListItem"><a class="navItem" href="/docs/renewals.html">Certificate Renewals</a></li><li class="navListItem"><a class="navItem" href="/docs/faq.html">Frequently Asked Questions</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/docs/dns-validation.html">About DNS Validation (dns-01)</a></li><li class="navListItem"><a class="navItem" href="/docs/http-validation.html">About HTTP Validation (http-01)</a></li><li class="navListItem"><a class="navItem" href="/docs/script-hooks.html">Scripting Hooks</a></li></ul></div><div class="navGroup navGroupActive"><h3>Useful Info</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/ssl-windows.html">Using Certificates in Windows</a></li><li class="navListItem"><a class="navItem" href="/docs/commandline.html">Command Line (CLI) Options</a></li><li class="navListItem"><a class="navItem" href="/docs/csv-import.html">CSV Bulk Import via Command Line</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/webprofusion/certify-docs/edit/master/docs/ssl-windows.md" target="_blank" rel="noreferrer noopener">Edit</a><h1>Using Certificates in Windows</h1></header><article><div><span><p>Using SSL/TLS certificates in Windows has a few aspects that can prevent your site working properly if don't know about them. This guide outlines some key points. <strong>See the special mention below for limitations regarding Windows Server 2008 R2 (IIS 7.5) and lower.</strong></p>
<h2><a class="anchor" aria-hidden="true" id="there-can-be-only-one-ssl-binding-per-port-ip"></a><a href="#there-can-be-only-one-ssl-binding-per-port-ip" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>There Can Be Only One (SSL Binding Per Port/IP)</h2>
<p>Windows only allows one SSL binding per specific IP, per Port (so typically port 443 for https). So if you use a fixed IP for your http website you probably don't want to do that for your SSL binding as well, unless you have lots of spare IP addresses on the server (you probably don't). This applies to all current versions of Windows.</p>
<h2><a class="anchor" aria-hidden="true" id="server-name-indication-sni"></a><a href="#server-name-indication-sni" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Server Name Indication (SNI)</h2>
<p>The good news is that if you <strong>do not specify a fixed IP for your binding</strong>, Windows can decide which website to match port 443 requests against using <strong>Server Name Indication (SNI)</strong>. This applies to Windows Server 2012 and higher, or versions running IIS 8.0 or higher.</p>
<p>If you use a binding of IP <em>All Unassigned</em> in IIS you can then share port 443 across multiple websites by also specifying the hostname to match against in your binding, and enabling SNI.</p>
<h2><a class="anchor" aria-hidden="true" id="binding-conflicts"></a><a href="#binding-conflicts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Binding Conflicts</h2>
<p>Certify configures bindings with SNI enabled for you by default, but <strong>if you already have fixed IP bindings for SSL certificates look out for issues</strong>. Unless you have multiple IP addresses (which are not specifically bound to another SSL certificate) then creating any new certificate bindings will result in a conflict, and you could start seeing the wrong certificate being served by IIS for your website.</p>
<p><strong>IP binding conflicts are the number one reason for certificate confusion in Windows/IIS.</strong>
If your site is serving the wrong certificate this is probably the cause.</p>
<h2><a class="anchor" aria-hidden="true" id="invalid-private-key-permissions"></a><a href="#invalid-private-key-permissions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Invalid Private Key Permissions</h2>
<p>If IIS cannot read or otherwise use the private key for your SSL certificate (either it's corrupted or it was created by a different user account) it will fallback to the next SSL Certificate it can find. This usually results in the website being presented with the wrong certificate (and results in various security errors in the Web Browsers). If IIS can't find another SSL certificate it will fail to serve any content at all. For this reason, be careful using non-standard accounts to create certificates. Changing the Certify SSL Manager background service to run under an alternative service account is not recommended or supported.</p>
<h1><a class="anchor" aria-hidden="true" id="windows-server-2008-r2-iis-75-limitations"></a><a href="#windows-server-2008-r2-iis-75-limitations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows Server 2008 R2 (IIS 7.5) Limitations</h1>
<p>Windows Server 2008 R2 and lower versions do not support SNI, so when a certificate binding is created it is associated with the IP address of the machine (actually the IP and port, usually port 443 for https). For this reason it is often difficult to use Server 2008 R2 or lower to host more than one https site.</p>
<p>Unless you have multiple IP addresses available on the machine (or you use a non-standard port) you will only be able to have one https/certificate binding in IIS. If two or more bindings point to the same certificate (for instance a Wildcard certificate, or a SAN certificate with multiple host names included), deleting one binding will also affect the other binding(s) and you will need to manually fix bindings.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="script-hooks.html">← Scripting Hooks</a><a class="docs-next button" href="commandline.html">Command Line (CLI) Options →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#there-can-be-only-one-ssl-binding-per-port-ip">There Can Be Only One (SSL Binding Per Port/IP)</a></li><li><a href="#server-name-indication-sni">Server Name Indication (SNI)</a></li><li><a href="#binding-conflicts">Binding Conflicts</a></li><li><a href="#invalid-private-key-permissions">Invalid Private Key Permissions</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/icon.svg" alt="Certify The Web - Docs" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/intro.html">Getting Started (or other categories)</a><a href="/docs/en/FAQ.html">FAQs</a></div><div><h5>Community</h5><a href="https://community.certifytheweb.com" target="_blank" rel="noreferrer noopener">Discuss</a><a href="https://twitter.com/certifytheweb/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://github.com/webprofusion/certify">GitHub</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Webprofusion Pty Ltd</section></footer></div></body></html>