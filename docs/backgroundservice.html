<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Certify SSL Manager background service · Certify The Web - Docs</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;In order to perform certificate requests and automatic renewals we install a background service called &amp;quot;Certify.Service&amp;quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Certify SSL Manager background service · Certify The Web - Docs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://certifytheweb.com/index.html"/><meta property="og:description" content="&lt;p&gt;In order to perform certificate requests and automatic renewals we install a background service called &amp;quot;Certify.Service&amp;quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information.&lt;/p&gt;
"/><meta property="og:image" content="https://certifytheweb.com/img/favicon.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://certifytheweb.com/img/favicon.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/icon.svg" alt="Certify The Web - Docs"/><h2 class="headerTitleWithLogo">Certify The Web - Docs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/intro.html" target="_self">Getting Started</a></li><li class=""><a href="/docs/faq.html" target="_self">FAQ</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/webprofusion/certify-docs/edit/master/docs/backgroundservice.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Certify SSL Manager background service</h1></header><article><div><span><p>In order to perform certificate requests and automatic renewals we install a background service called &quot;Certify.Service&quot; (Certify SSL Manager Service). This service is installed to run as Local System and requires that the Local System account has the necessary privileges to administer IIS (if required) and the computers certificate store, as well as writing to the C:\ProgramData\Certify folder for configuration information.</p>
<h2><a class="anchor" aria-hidden="true" id="port-9696-is-the-default-service-port"></a><a href="#port-9696-is-the-default-service-port" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Port 9696 is the default service port</h2>
<p>By default the background service runs a local http API server on port 9696 for the UI to talk to (bound to localhost and requiring windows authentication). <em>Do not open this port to external traffic on your firewall.</em></p>
<h2><a class="anchor" aria-hidden="true" id="custom-configuration-and-troubleshooting-service-not-started-error"></a><a href="#custom-configuration-and-troubleshooting-service-not-started-error" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom configuration and Troubleshooting &quot;..service not started&quot; error</h2>
<p>The certify background service operates a local API for the app on port <code>9696</code> by default. If this port is in use by another application/service (or for some other reason it cannot create a binding to <code>localhost:9696</code>, or a security product is preventing <strong>local</strong> port access) then you will see the message 'Service not started'.</p>
<p>The app should try to negotiate a different service port if it detects that the port is already in use, however you can manually specify the settings if required by editing/adding the file <code>c:\programdata\certify\serviceconfig.json</code> with content as per the following (adjusted as required) then restarting both the service and UI:</p>
<pre><code class="hljs css language-json">{
 <span class="hljs-attr">"host"</span>:<span class="hljs-string">"localhost"</span>,
 <span class="hljs-attr">"port"</span>:<span class="hljs-number">9696</span>
}
</code></pre>
<p>For example an alternative configuration might be:</p>
<pre><code class="hljs css language-json">{
 <span class="hljs-attr">"host"</span>:<span class="hljs-string">"127.0.0.1"</span>,
 <span class="hljs-attr">"port"</span>:<span class="hljs-number">9695</span>
}
</code></pre>
<p>To test that the reconfigured service is communicating OK, you can try opening the following URL in your browser:
<code>http://localhost:9695/api/system/appversion</code> where 'localhost' is your configured service <code>host</code> value and <code>9695</code> is an example configured port.</p>
<h2><a class="anchor" aria-hidden="true" id="other-considerations-for-service-not-started"></a><a href="#other-considerations-for-service-not-started" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other Considerations for 'Service Not Started..'</h2>
<p>To operate properly the background service needs to be able to register an http listener for it's API server via http.sys, in some versions of windows the Http kernel service may not be enabled and you will need to enable it.</p>
<p>By default the windows http service is typically enabled but if you receive the error 'Operation is not supported on this platform' in <code>service.exceptions.log</code> then try checking the status of the windows http service. To do so, run the following from an elevated command prompt (using Run As Administrator):</p>
<pre><code class="hljs css language-bat">sc query http
</code></pre>
<p>This should produce output like:</p>
<pre><code class="hljs css language-bat"><span class="hljs-function">SERVICE_NAME: <span class="hljs-title">http</span>
        <span class="hljs-title">TYPE</span>               : 1  <span class="hljs-title">KERNEL_DRIVER</span>
        <span class="hljs-title">STATE</span>              : 4  <span class="hljs-title">RUNNING</span>
                                (<span class="hljs-title">STOPPABLE</span>, <span class="hljs-title">NOT_PAUSABLE</span>, <span class="hljs-title">IGNORES_SHUTDOWN</span>)
        <span class="hljs-title">WIN32_EXIT_CODE</span>    : 0  (0<span class="hljs-title">x0</span>)
        <span class="hljs-title">SERVICE_EXIT_CODE</span>  : 0  (0<span class="hljs-title">x0</span>)
        <span class="hljs-title">CHECKPOINT</span>         : 0<span class="hljs-title">x0</span>
        <span class="hljs-title">WAIT_HINT</span>          : 0<span class="hljs-title">x0</span>

</span></code></pre>
<p>If the state is not <code>RUNNING</code> use the following command the enable the service on demand:</p>
<pre><code class="hljs css language-bat">sc config http <span class="hljs-built_in">start</span>= demand
</code></pre>
<p>Then start the http service</p>
<pre><code class="hljs css language-bat"><span class="hljs-built_in">net</span> <span class="hljs-built_in">start</span> http`
</code></pre>
<p>If the service remains at <code>STOPPING</code> or similar then a system reboot may be required.</p>
<p>Once completed, restart the Certift SSL Manager background service from local services, then open the Certify The Web UI again to see if it can connect.</p>
<p>In other cases, you may have permission restrictions on port bindings to localhost, so you may have to modify these <a href="https://docs.microsoft.com/en-us/windows/desktop/http/add-urlacl">https://docs.microsoft.com/en-us/windows/desktop/http/add-urlacl</a> or change the service config as above.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#port-9696-is-the-default-service-port">Port 9696 is the default service port</a></li><li><a href="#custom-configuration-and-troubleshooting-service-not-started-error">Custom configuration and Troubleshooting &quot;..service not started&quot; error</a></li><li><a href="#other-considerations-for-service-not-started">Other Considerations for 'Service Not Started..'</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/icon.svg" alt="Certify The Web - Docs" width="66" height="58"/></a><div><h5>Community</h5><a href="https://community.certifytheweb.com" target="_blank" rel="noreferrer noopener">Discuss</a><a href="https://twitter.com/certifytheweb/" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://github.com/webprofusion/certify">GitHub</a></div><div><h5>Help</h5><a href="https://certifytheweb.com/">Website</a><a href="https://certifytheweb.com/docs">Support</a><a href="https://github.com/webprofusion/certify/issues">Issues</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Webprofusion Pty Ltd</section></footer></div></body></html>